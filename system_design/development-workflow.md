# 项目开发链路与里程碑
> 本文档旨在结合**项目分工**、**技术选型**与**定制化功能设计**，为“IP智慧解答专家系统”项目的所有成员提供一份统一、清晰、可执行的端到端开发指南与路线图。

## 第一阶段：需求分析、架构设计与环境准备

此阶段的核心目标是完成所有前期设计工作，并为后续的并行开发铺平道路，确保所有云服务和本地环境都配置妥当。

### 1.1 设计与规划任务

- [x] **市场与竞品分析**：研究现有的智能问答应用，明确本项目核心优势。
- [x] **产品与UI设计**：绘制系统主要界面的前端设计稿与UI稿，突出“智能问答”与“知识库管理”两大核心。
- [x] **技术架构设计**：完成项目技术选型、后端数据库结构设计，并由前后端共同定义出核心API接口文档。

### 1.2 技术实现：环境搭建与云服务配置

本节为将架构设计落地的详细步骤。

#### 1.2.1 本地开发环境搭建

##### Git LFS 安装与配置 (全体成员)
此内容见 **[协作规范 (CONTRIBUTING.md)](../CONTRIBUTING.md)** 文档。

##### 前端环境 (前端团队)
- **Node.js**: 推荐使用 `nvm` (Node Version Manager) 来管理 Node.js 版本，以避免潜在的版本冲突。
  ```bash
  # 安装 nvm 并使用推荐的 LTS 版本
  nvm install --lts
  nvm use --lts
  ```
- **Yarn**: 安装项目依赖包管理器 Yarn。
  ```bash
  npm install -g yarn
  ```
- **安装依赖**: 在前端代码目录下执行。
  ```bash
  yarn install
  ```

##### 后端与模型环境 (后端/模型团队)
- **Python**: 建议使用 `pyenv` 或 `conda` 管理 Python 版本，本项目推荐使用 `Python 3.10` 或更高版本。
- **安装依赖**: 在后端代码目录下，建议先创建并激活虚拟环境，再安装依赖。
  ```bash
  # 创建虚拟环境
  python -m venv venv
  # 激活虚拟环境 (macOS/Linux)
  source venv/bin/activate
  # 激活虚拟环境 (Windows)
  .\venv\Scripts\activate
  # 安装依赖
  pip install -r requirements.txt
  ```

#### 1.2.2 阿里云 "0成本" 部署方案实战 (后端/模型团队)

##### 前置准备：获取学生权益
一切“0成本”部署的基础是获得阿里云的学生身份认证。
1.  **注册与实名**：注册阿里云账号，并完成个人实名认证。
2.  **学生认证**：访问“[高校学生“飞天加速计划”](https://developer.aliyun.com/plan/student)”页面，按照指引完成学生身份认证。

##### 步骤一：部署模型服务 (PAI-EAS)
1.  登录阿里云控制台，进入 **“PAI-EAS 模型在线服务”**。
2.  点击 **“部署服务”**，选择 **“模型服务市场”**。
3.  **部署嵌入模型**:
    - 在市场中搜索 `bge-large-zh-v1.5`。
    - 点击“免费部署”，选择 **“免费版（1核 CPU, 2GB 内存）”** 规格，点击“一键部署”。
    - 记录下**在线服务地址 (Endpoint)** 和 **访问令牌 (Token)**。
4.  **部署大语言模型**:
    - 重复以上步骤，在市场中搜索 `qwen-7b-chat-int4`。
    - 同样使用 **“免费版”** 规格进行部署，并记录下其 **Endpoint** 和 **Token**。

##### 步骤二：创建存储服务 (OSS & RDS)
1.  **对象存储 OSS**:
    - 进入“对象存储 OSS”控制台，创建**两个** Bucket：
        - `ip-expert-frontend` (示例名): 权限设为“**公共读**”，用于托管前端。
        - `ip-expert-knowledge-base` (示例名): 权限设为“**私有**”，用于存放知识文档。
2.  **关系型数据库 RDS**:
    - 进入“关系型数据库 RDS”控制台，申请一个免费试用或学生优惠的MySQL实例。
    - 创建后，设置**数据库账号和密码**，并将IP地址添加到**白名单**。

##### 步骤三：创建向量数据库 (以OpenSearch为例)
1.  进入 **“阿里云OpenSearch”** 控制台，选择 **“向量检索版”**。
2.  申请开通“新用户免费试用套餐”，并 **“创建实例”**。
3.  实例创建后，创建一个新的**索引**，并记录下实例的**公网访问地址**和**API密钥**。

##### 步骤四：配置后端计算服务 (函数计算 FC)
1.  进入 **“函数计算 FC”** 控制台，创建一个新的**服务**和**函数**。
2.  **运行环境**选 `Python 3.10`，**处理方式**选“处理HTTP请求”。
3.  上传改造后的Flask项目代码包，并创建一个 **“HTTP(S)触发器”**。
4.  记录下生成的公网访问URL。

<br>

## 第二阶段：并行开发

此阶段是项目的主体，各团队根据职责划分，并行开发核心功能模块。此阶段预期持续约 **1.5 个月**。

### A. 前端开发团队 (2人)
- **核心目标**: 根据设计稿完成用户界面、问答交互、数据可视化看板的开发。
- **具体实施**:
    - [ ] **任务1：项目初始化与布局**
        - **步骤**:
            - 使用 `yarn` 初始化 `Vue3 + TypeScript` 项目。
            - 引入 **Ant Design Vue** UI库。
            - 搭建UI/UX蓝图中定义的**三栏式布局**。
        - **关键技术栈**: `Vue3`, `TypeScript`, `AntD Vue`, `Vite`

    - [ ] **任务2：认证与案例管理**
        - **步骤**:
            - 开发登录 `Modal`，调用 `/auth/login` 接口，并将JWT存储在本地。
            - 封装 `fetch` 请求，统一处理`Authorization`头部。
            - 调用 `GET /cases` 获取并展示诊断历史列表。
        - **关键技术栈**: `Vue Router`

    - [ ] **任务3：可视化诊断图**
        - **步骤**:
            - 在主画布区域，使用**SVG**或图表库（如`d3.js`, `G6`）渲染后端返回的节点和边。
            - 实现节点的拖拽、缩放、点击交互。
        - **关键技术栈**: `SVG / d3.js / G6`

    - [ ] **任务4：核心交互界面**
        - **步骤**:
            - **右侧详情面板**：根据节点类型，动态展示节点详情、知识溯源或可复制命令。
            - **Agent追问**：当节点状态为`AWAITING_USER_INPUT`时，渲染输入框，调用`/interactions`接口。
            - **知识溯源**：渲染可点击的引用标签`[doc1]`，并高亮展示原文片段。
        - **关键技术栈**: `Vue3 (动态组件)`

    - [ ] **任务5：数据看板与设置**
        - **步骤**: 开发“数据看板”和“系统设置”页面。
        - **关键技术栈**: `ECharts / AntV`

### B. 后端开发团队 (3人)
- **核心目标**: 实现服务架构、混合检索算法、知识库管理等核心功能。
- **具体实施**:
    - [ ] **任务1：Flask项目搭建与认证**
        - **步骤**:
            - 初始化Flask项目，使用 **SQLAlchemy** 定义数据库模型。
            - 实现 `/auth/login` 接口，使用 **JWT** 生成Token。
        - **关键技术栈**: `Flask`, `SQLAlchemy`, `marshmallow`

    - [ ] **任务2：知识处理流水线**
        - **步骤**:
            - 编写由OSS触发的**函数计算 (FC)** 函数。
            - 负责：1) 解析文档；2) 文本切片；3) 调用**BGE模型API**向量化；4) 写入向量数据库。
        - **关键技术栈**: `LangChain` (文档加载/切分)

    - [ ] **任务3：混合检索API核心**
        - **步骤**:
            - 利用 `LangChain` 的 **`EnsembleRetriever`** 实现向量与关键词的混合检索。
            - 使用 **RRF (倒数排名融合)** 算法对结果重排序。
        - **关键技术栈**: `LangChain`, `Weaviate/OpenSearch`

    - [ ] **任务4：Agentic多轮对话框架**
        - **步骤**:
            - 使用 **`langgraph`** 构建状态机管理诊断流程。
            - 实现“分析查询”、“RAG检索”、“追问用户”等节点，实现主动追问。
        - **关键技术栈**: `langgraph`, `Qwen (PAI-EAS)`

    - [ ] **任务5：核心业务API实现**
        - **步骤**: 实现 `POST /cases`、`POST /cases/{caseId}/interactions`、`POST /cases/{caseId}/feedback` 等核心接口。
        - **关键技术栈**: `Flask`, `langgraph`

### C. 模型应用与调优团队 (2人)
- **核心目标**: 完成数据清洗、向量数据库构建、大模型接口集成与提示词工程优化。
- **具体实施**:
    - [ ] **任务1：数据收集与预处理**
        - **步骤**: 收集RFC文档、设备手册等，并进行清洗和格式转换。
        - **关键技术栈/工具**: `Python (BeautifulSoup, pdfplumber)`

    - [ ] **任务2：提示词工程 (Prompt)**
        - **步骤**:
            - 设计并迭代用于`langgraph`各个节点的Prompt。
            - **重点**：引导模型判断信息是否充分、强制模型引用上下文并带上`[doc]`标记。
        - **关键技术栈/工具**: `LangSmith`

    - [ ] **任务3：RAG系统评估**
        - **步骤**:
            - 搭建 **RAGAs** 评估框架，构建评测集。
            - 从**答案相关性、忠实度、召回率**等维度量化评估RAG效果。
        - **关键技术栈/工具**: `RAGAs`, `Python`

    - [ ] **任务4：(进阶)小模型微调**
        - **步骤**:
            - 整理运维日志或问题分类数据集。
            - 尝试使用`BERT`等小模型微调一个**问题意图分类器**。
        - **关键技术栈/工具**: `Hugging Face Transformers`

<br>

## 第三阶段：联调测试与交付

此阶段的目标是整合所有功能，进行端到端测试，并完成所有交付材料的准备工作。

- [ ] **集成联调**：完成前后端整体功能联调与端到端测试。
- [ ] **交付材料准备**：录制并剪辑最终的参赛演示视频，完成技术白皮书的撰写。
- [ ] **部署与演示**：完成项目部署，准备最终答辩。

- [ ] **任务1：端到端联调 (全体开发)**
    - **步骤**:
        - 前端完整接入所有后端API，确保数据流和交互逻辑正确无误。
        - 重点测试**创建诊断 -> Agent追问 -> 用户补充 -> 生成方案 -> 提交反馈**的全流程。

- [ ] **任务2：交付材料准备 (演示与文档负责人)**
    - **步骤**:
        - **技术白皮书**：综合所有设计文档和开发实践，撰写最终的技术白皮书。
        - **演示视频**：设计演示脚本，录制并剪辑一个能完整展示项目亮点的视频。

- [ ] **任务3：部署与预演 (全体开发)**
    - **步骤**:
        - 将前后端应用完整部署到“0成本”方案的阿里云环境中。
        - 进行答辩预演，确保系统稳定，演示流畅。 